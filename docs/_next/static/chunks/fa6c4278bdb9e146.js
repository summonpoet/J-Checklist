(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9843,e=>{"use strict";var t=e.i(43476),s=e.i(71645);let l=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:n="",children:i,iconNode:c,...d},m)=>(0,s.createElement)("svg",{ref:m,...o,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:l("lucide",n),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(i)?i:[i]])),n=(e,t)=>{let o=(0,s.forwardRef)(({className:o,...n},i)=>(0,s.createElement)(r,{ref:i,iconNode:t,className:l(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,o),...n}));return o.displayName=a(e),o},i=n("list-todo",[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]]),c=n("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),d=n("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),m=n("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);function x(e,t){let[l,a]=(0,s.useState)(t),[o,r]=(0,s.useState)(!1);(0,s.useEffect)(()=>{try{let t=window.localStorage.getItem(e);t&&a(JSON.parse(t))}catch(t){console.warn(`Error reading localStorage key "${e}":`,t)}r(!0)},[e]);let n=(0,s.useCallback)(t=>{try{let s=t instanceof Function?t(l):t;a(s),window.localStorage.setItem(e,JSON.stringify(s))}catch(t){console.warn(`Error setting localStorage key "${e}":`,t)}},[e,l]);return{value:l,setValue:n,removeValue:(0,s.useCallback)(()=>{try{a(t),window.localStorage.removeItem(e)}catch(t){console.warn(`Error removing localStorage key "${e}":`,t)}},[e,t]),isLoaded:o}}function h(){return new Date().toISOString().split("T")[0]}function u(e){return{actionId:e,completedCount:0,currentExecution:null,isCompletedToday:!1,executions:[],lastUpdated:Date.now()}}async function p(e,t){let s,l,a={"Content-Type":"application/json"};switch(e.provider){case"openai":s="https://api.openai.com/v1/chat/completions",a.Authorization=`Bearer ${e.apiKey}`,l={model:e.model||"gpt-4o-mini",messages:[{role:"user",content:t}],temperature:.7};break;case"anthropic":s="https://api.anthropic.com/v1/messages",a["x-api-key"]=e.apiKey,a["anthropic-version"]="2023-06-01",l={model:e.model||"claude-3-5-sonnet-20241022",max_tokens:1024,messages:[{role:"user",content:t}]};break;case"moonshot":s="https://api.moonshot.cn/v1/chat/completions",a.Authorization=`Bearer ${e.apiKey}`,l={model:e.model||"moonshot-v1-8k",messages:[{role:"user",content:t}],temperature:.7};break;case"zhipu":s="https://open.bigmodel.cn/api/paas/v4/chat/completions",a.Authorization=`Bearer ${e.apiKey}`,l={model:e.model||"glm-4-flash",messages:[{role:"user",content:t}],temperature:.7};break;case"custom":s=e.apiUrl||"",a.Authorization=`Bearer ${e.apiKey}`,l={model:e.model,messages:[{role:"user",content:t}],temperature:.7};break;default:throw Error("不支持的 AI 提供商")}let o=await fetch(s,{method:"POST",headers:a,body:JSON.stringify(l)});if(!o.ok){let e=await o.text();throw Error(`API 调用失败: ${e}`)}let r=await o.json();return"anthropic"===e.provider?r.content?.[0]?.text||"":r.choices?.[0]?.message?.content||""}let g=n("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),b=n("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),f=n("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),y=n("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),j=n("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),v={low:{label:"低",color:"bg-green-100 text-green-700 border-green-200"},medium:{label:"中",color:"bg-yellow-100 text-yellow-700 border-yellow-200"},high:{label:"高",color:"bg-red-100 text-red-700 border-red-200"}},N={low:{label:"低",color:"bg-gray-100 text-gray-600 border-gray-200"},medium:{label:"中",color:"bg-blue-100 text-blue-700 border-blue-200"},high:{label:"高",color:"bg-purple-100 text-purple-700 border-purple-200"}};function w({actionItems:e,onAdd:l,onUpdate:a,onDelete:o}){let[r,n]=(0,s.useState)(!1),[i,d]=(0,s.useState)(null),[m,x]=(0,s.useState)(""),[h,u]=(0,s.useState)("medium"),[p,w]=(0,s.useState)("medium"),[k,C]=(0,s.useState)(1),[I,$]=(0,s.useState)(!1),M=()=>{x(""),u("medium"),w("medium"),C(1),$(!1)},T=r||null!==i;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c,{className:"w-5 h-5 text-stone-600"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-stone-800",children:"管理行动项"})]}),(0,t.jsxs)("span",{className:"text-sm text-stone-500",children:[e.length," 个行动项"]})]}),!T&&(0,t.jsxs)("button",{onClick:()=>n(!0),className:"w-full py-3 px-4 border-2 border-dashed border-stone-300 rounded-xl text-stone-500 hover:border-stone-400 hover:text-stone-600 hover:bg-stone-50 transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)(g,{className:"w-5 h-5"}),"添加行动项"]}),T&&(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-stone-200 p-4 space-y-4 shadow-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-1.5",children:"行动项名称"}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),placeholder:"例如：阅读30分钟",className:"w-full px-3 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-500 focus:border-transparent",autoFocus:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-1.5",children:"难度"}),(0,t.jsx)("div",{className:"flex gap-2",children:["low","medium","high"].map(e=>(0,t.jsx)("button",{onClick:()=>u(e),className:`flex-1 py-2 px-1 rounded-lg border text-sm font-medium transition-colors ${h===e?v[e].color+" ring-2 ring-offset-1":"bg-stone-50 text-stone-600 border-stone-200 hover:bg-stone-100"}`,children:v[e].label},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-1.5",children:"重要度"}),(0,t.jsx)("div",{className:"flex gap-2",children:["low","medium","high"].map(e=>(0,t.jsx)("button",{onClick:()=>w(e),className:`flex-1 py-2 px-1 rounded-lg border text-sm font-medium transition-colors ${p===e?N[e].color+" ring-2 ring-offset-1":"bg-stone-50 text-stone-600 border-stone-200 hover:bg-stone-100"}`,children:N[e].label},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-1.5",children:"一日几次"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:()=>C(Math.max(1,k-1)),className:"w-10 h-10 rounded-lg border border-stone-300 flex items-center justify-center hover:bg-stone-100 transition-colors",children:"-"}),(0,t.jsx)("span",{className:"w-16 text-center text-lg font-semibold text-stone-800",children:k}),(0,t.jsx)("button",{onClick:()=>C(k+1),className:"w-10 h-10 rounded-lg border border-stone-300 flex items-center justify-center hover:bg-stone-100 transition-colors",children:"+"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-1.5",children:"有始有终？"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>$(!1),className:`flex-1 py-2.5 px-4 rounded-lg border text-sm font-medium transition-colors ${!I?"bg-stone-800 text-white border-stone-800":"bg-stone-50 text-stone-600 border-stone-200 hover:bg-stone-100"}`,children:"否，只记录完成"}),(0,t.jsx)("button",{onClick:()=>$(!0),className:`flex-1 py-2.5 px-4 rounded-lg border text-sm font-medium transition-colors ${I?"bg-stone-800 text-white border-stone-800":"bg-stone-50 text-stone-600 border-stone-200 hover:bg-stone-100"}`,children:"是，记录时间"})]}),(0,t.jsx)("p",{className:"mt-1.5 text-xs text-stone-500",children:I?'使用时需要点击"开干"和"干完"来记录用时':'使用时只需点击"干"来记录完成'})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsxs)("button",{onClick:()=>{d(null),n(!1),M()},className:"flex-1 py-2.5 px-4 border border-stone-300 rounded-lg text-stone-600 hover:bg-stone-50 transition-colors flex items-center justify-center gap-1.5",children:[(0,t.jsx)(y,{className:"w-4 h-4"}),"取消"]}),(0,t.jsxs)("button",{onClick:i?()=>{i&&m.trim()&&(a(i,{name:m.trim(),difficulty:h,importance:p,timesPerDay:k,hasDuration:I}),d(null),M())}:()=>{m.trim()&&(l(m.trim(),h,p,k,I),M(),n(!1))},disabled:!m.trim(),className:"flex-1 py-2.5 px-4 bg-stone-800 text-white rounded-lg hover:bg-stone-700 disabled:bg-stone-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-1.5",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),i?"保存":"添加"]})]})]}),e.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-xl border border-stone-200 p-4 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-stone-800 truncate",children:e.name}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[(0,t.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${v[e.difficulty].color}`,children:["难度: ",v[e.difficulty].label]}),(0,t.jsxs)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${N[e.importance].color}`,children:["重要: ",N[e.importance].label]}),(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-stone-100 text-stone-600 border border-stone-200",children:[e.timesPerDay,"次/天"]}),e.hasDuration&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-700 border border-orange-200",children:"计时"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 ml-2",children:[(0,t.jsx)("button",{onClick:()=>{d(e.id),x(e.name),u(e.difficulty),w(e.importance),C(e.timesPerDay),$(e.hasDuration)},className:"p-2 text-stone-400 hover:text-stone-600 hover:bg-stone-100 rounded-lg transition-colors",children:(0,t.jsx)(f,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>o(e.id),className:"p-2 text-stone-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,t.jsx)(b,{className:"w-4 h-4"})})]})]})},e.id))}),0===e.length&&!r&&(0,t.jsxs)("div",{className:"text-center py-8 text-stone-400",children:[(0,t.jsx)("p",{children:"还没有行动项"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"点击上方按钮添加你的第一个行动项"})]})]})}let k=n("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),C=n("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),I=n("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),$=n("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]),M=n("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),T=n("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),D=n("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),A=n("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),S={low:"bg-green-500",medium:"bg-yellow-500",high:"bg-red-500"},E={low:"bg-gray-400",medium:"bg-blue-500",high:"bg-purple-500"};function z(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),l=Math.floor(s/60);return l>0?`${l}小时${s%60}分钟`:s>0?`${s}分钟${t%60}秒`:`${t}秒`}function P({current:e,max:s,color:l}){let a=Math.min(100,e/s*100),o=Math.ceil(s);return(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(D,{className:"w-4 h-4 text-orange-500"}),(0,t.jsx)("div",{className:"flex-1 h-2.5 bg-stone-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:`h-full ${l} transition-all duration-500 ease-out rounded-full`,style:{width:`${a}%`}})}),(0,t.jsxs)("span",{className:"text-xs font-medium text-stone-600 min-w-[3rem] text-right",children:[e,"/",s]})]}),(0,t.jsx)("div",{className:"flex gap-1",children:Array.from({length:o}).map((s,a)=>(0,t.jsx)("div",{className:`w-2 h-2 rounded-full transition-colors duration-300 ${a<e?l:"bg-stone-200"}`},a))})]})}function R({task:e,actionItem:l,onStart:a,onCompleteWithDuration:o,onCompleteSimple:r,onCancel:n}){let i=e.currentExecution?.startTime!==null&&e.currentExecution?.endTime===null,[c,d]=(0,s.useState)(0);(0,s.useEffect)(()=>{if(!i||!e.currentExecution?.startTime)return void d(0);let t=setInterval(()=>{d(Date.now()-e.currentExecution.startTime)},1e3);return()=>clearInterval(t)},[i,e.currentExecution]);let m=(0,s.useMemo)(()=>"high"===l.importance?"bg-purple-500":"medium"===l.importance?"bg-blue-500":"bg-stone-500",[l.importance]);if(e.isCompletedToday){let s=e.executions.reduce((e,t)=>e+t.duration,0);return(0,t.jsx)("div",{className:"bg-stone-50 rounded-xl border border-stone-200 p-4 opacity-75",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,t.jsx)(I,{className:"w-5 h-5 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-stone-600 line-through",children:l.name}),(0,t.jsxs)("p",{className:"text-xs text-stone-400",children:["已完成 ",e.completedCount,"/",l.timesPerDay," 次",s>0&&` \xb7 总用时 ${z(s)}`]})]})]}),(0,t.jsx)("span",{className:"text-sm font-medium text-green-600",children:"✓"})]})})}return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-stone-200 p-4 shadow-sm",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-stone-800",children:l.name}),(0,t.jsxs)("div",{className:"mt-1 flex flex-wrap gap-1.5",children:[(0,t.jsx)("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium text-white ${S[l.difficulty]}`,children:"难度"}),(0,t.jsx)("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium text-white ${E[l.importance]}`,children:"重要"}),l.hasDuration&&(0,t.jsxs)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium bg-orange-100 text-orange-700",children:[(0,t.jsx)($,{className:"w-3 h-3 mr-0.5"}),"计时"]})]})]})}),l.timesPerDay>1&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(P,{current:e.completedCount,max:l.timesPerDay,color:m})}),i&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-orange-50 rounded-lg border border-orange-100",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-orange-800",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"进行中"}),(0,t.jsx)("span",{className:"text-lg font-mono font-semibold ml-auto",children:z(c)})]})}),(0,t.jsx)("div",{className:"flex gap-2",children:l.hasDuration?i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>n(l.id),className:"flex-1 py-2.5 px-4 border border-stone-300 rounded-lg text-stone-600 hover:bg-stone-50 transition-colors text-sm font-medium",children:"取消"}),(0,t.jsxs)("button",{onClick:()=>o(l.id),className:"flex-[2] py-2.5 px-4 bg-stone-800 text-white rounded-lg hover:bg-stone-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[(0,t.jsx)(C,{className:"w-4 h-4 fill-current"}),"干完"]})]}):(0,t.jsxs)("button",{onClick:()=>a(l.id),className:"w-full py-2.5 px-4 bg-stone-800 text-white rounded-lg hover:bg-stone-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[(0,t.jsx)(k,{className:"w-4 h-4 fill-current"}),"开干"]}):(0,t.jsxs)("button",{onClick:()=>r(l.id),className:"w-full py-2.5 px-4 bg-stone-800 text-white rounded-lg hover:bg-stone-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[(0,t.jsx)(I,{className:"w-4 h-4"}),"干"]})})]})}function q({sortedTasks:e,onStart:l,onCompleteWithDuration:a,onCompleteSimple:o,onCancel:r}){let n,i,c=(0,s.useMemo)(()=>new Date().toISOString().split("T")[0],[]),d=(0,s.useMemo)(()=>{let t=e.length,s=e.filter(({task:e})=>e.isCompletedToday).length,l=e.filter(({task:e})=>e.currentExecution?.startTime&&!e.currentExecution?.endTime).length,a=t>0?Math.round(s/t*100):0;return{total:t,completed:s,inProgress:l,completionRate:a}},[e]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(M,{className:"w-5 h-5 text-stone-600"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-stone-800",children:"今日任务"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-stone-500",children:[(0,t.jsx)(A,{className:"w-4 h-4"}),(n=new Date(c),i=new Date,n.toDateString()===i.toDateString()?"今天":`${n.getMonth()+1}月${n.getDate()}日`)]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-stone-200 p-3 text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-stone-800",children:d.completed}),(0,t.jsx)("p",{className:"text-xs text-stone-500 mt-0.5",children:"已完成"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-stone-200 p-3 text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-stone-800",children:d.inProgress}),(0,t.jsx)("p",{className:"text-xs text-stone-500 mt-0.5",children:"进行中"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-stone-200 p-3 text-center",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-stone-800",children:[d.completionRate,"%"]}),(0,t.jsx)("p",{className:"text-xs text-stone-500 mt-0.5",children:"完成率"})]})]}),e.length>0?(0,t.jsx)("div",{className:"space-y-3",children:e.map(({task:e,actionItem:s})=>(0,t.jsx)(R,{task:e,actionItem:s,onStart:l,onCompleteWithDuration:a,onCompleteSimple:o,onCancel:r},e.actionId))}):(0,t.jsxs)("div",{className:"text-center py-12 bg-stone-50 rounded-xl border border-dashed border-stone-300",children:[(0,t.jsx)(T,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-stone-500 font-medium",children:"还没有行动项"}),(0,t.jsx)("p",{className:"text-sm text-stone-400 mt-1",children:'先去"管理"界面添加吧'})]})]})}let O=n("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),K=n("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),U=n("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),L=n("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),B=n("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),J=n("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),V=n("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),W=n("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),F=n("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Z=[{value:"moonshot",label:"Moonshot (Kimi)",models:["moonshot-v1-8k","moonshot-v1-32k","moonshot-v1-128k"]},{value:"zhipu",label:"智谱 AI (GLM)",models:["glm-4-flash","glm-4","glm-4-plus"]},{value:"openai",label:"OpenAI",models:["gpt-4o-mini","gpt-4o","gpt-3.5-turbo"]},{value:"anthropic",label:"Anthropic (Claude)",models:["claude-3-5-sonnet-20241022","claude-3-opus-20240229"]},{value:"custom",label:"自定义 API",models:["自定义模型"]}];function _({isOpen:e,onClose:l,onSave:a,existingConfig:o}){let[r,n]=(0,s.useState)(o?.provider||"moonshot"),[i,c]=(0,s.useState)(o?.apiKey||""),[m,x]=(0,s.useState)(o?.apiUrl||""),[h,u]=(0,s.useState)(o?.model||""),[p,g]=(0,s.useState)(!1),b=Z.find(e=>e.value===r),f=b?.models[0]||"";return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fade-in",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-xl",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-stone-200 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-5 h-5 text-purple-500"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-stone-800",children:"配置 AI 教练"})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 text-stone-400 hover:text-stone-600 hover:bg-stone-100 rounded-lg transition-colors",children:(0,t.jsx)(y,{className:"w-5 h-5"})})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i.trim()&&(a({provider:r,apiKey:i.trim(),apiUrl:"custom"===r?m.trim():void 0,model:h||f}),l())},className:"p-6 space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"选择 AI 提供商"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Z.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{n(e.value),u(e.models[0])},className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${r===e.value?"bg-stone-800 text-white":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"API Key"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),(0,t.jsx)("input",{type:p?"text":"password",value:i,onChange:e=>c(e.target.value),placeholder:"输入你的 API Key",className:"w-full pl-10 pr-10 py-2.5 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-500 focus:border-transparent",required:!0}),(0,t.jsx)("button",{type:"button",onClick:()=>g(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-stone-400 hover:text-stone-600",children:p?(0,t.jsx)(F,{className:"w-5 h-5"}):(0,t.jsx)(W,{className:"w-5 h-5"})})]}),(0,t.jsx)("p",{className:"mt-1.5 text-xs text-stone-500",children:"API Key 仅保存在你的浏览器本地，不会上传到任何服务器"})]}),"custom"===r&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"API 地址"}),(0,t.jsx)("input",{type:"url",value:m,onChange:e=>x(e.target.value),placeholder:"https://api.example.com/v1/chat/completions",className:"w-full px-3 py-2.5 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"模型"}),(0,t.jsx)("select",{value:h||f,onChange:e=>u(e.target.value),className:"w-full px-3 py-2.5 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-stone-500 focus:border-transparent bg-white",children:b?.models.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("button",{type:"submit",disabled:!i.trim(),className:"w-full py-3 bg-stone-800 text-white rounded-lg font-medium hover:bg-stone-700 disabled:bg-stone-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)(d,{className:"w-4 h-4"}),"保存并启用 AI 教练"]})]})]})}):null}let G={excellent:{label:"超棒",color:"text-green-600 bg-green-100",icon:O},good:{label:"不错",color:"text-blue-600 bg-blue-100",icon:T},average:{label:"还行",color:"text-yellow-600 bg-yellow-100",icon:$},poor:{label:"加油",color:"text-orange-600 bg-orange-100",icon:B}};function H({label:e,value:s,subtext:l,color:a="stone"}){return(0,t.jsxs)("div",{className:`p-4 rounded-xl border ${{green:"bg-green-50 border-green-200",blue:"bg-blue-50 border-blue-200",purple:"bg-purple-50 border-purple-200",stone:"bg-stone-50 border-stone-200"}[a]}`,children:[(0,t.jsx)("p",{className:"text-xs text-stone-500 mb-1",children:e}),(0,t.jsx)("p",{className:"text-2xl font-bold text-stone-800",children:s}),l&&(0,t.jsx)("p",{className:"text-xs text-stone-400 mt-1",children:l})]})}function Q({label:e,completed:s,total:l,color:a="stone"}){let o=l>0?Math.round(s/l*100):0;return(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-stone-600",children:e}),(0,t.jsxs)("span",{className:"text-stone-800 font-medium",children:[s,"/",l]})]}),(0,t.jsx)("div",{className:"h-2 bg-stone-200 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:`h-full ${{green:"bg-green-500",blue:"bg-blue-500",purple:"bg-purple-500",red:"bg-red-500",stone:"bg-stone-500"}[a]} transition-all duration-500 rounded-full`,style:{width:`${o}%`}})})]})}function X({config:e,todayReview:l,todayStats:a,history:o,isAnalyzing:r,error:n,onSaveConfig:i,onAnalyze:m,onClearReview:x}){let h,[u,p]=(0,s.useState)(!1),[g,b]=(0,s.useState)(!1);return e?r?(0,t.jsx)("div",{className:"bg-white rounded-2xl border border-stone-200 p-8",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-12 h-12 border-3 border-stone-200 border-t-purple-500 rounded-full animate-spin"}),(0,t.jsx)(d,{className:"w-5 h-5 text-purple-500 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-stone-800 font-medium",children:"AI 教练正在分析中..."}),(0,t.jsx)("p",{className:"text-sm text-stone-500 mt-1",children:"正在对比历史数据，生成今日评价"})]})]})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d,{className:"w-5 h-5 text-purple-500"}),(0,t.jsx)("h2",{className:"text-lg font-semibold text-stone-800",children:"AI 养成教练"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>b(!g),className:"px-3 py-1.5 text-sm text-stone-600 hover:bg-stone-100 rounded-lg transition-colors",children:g?"隐藏历史":"查看历史"}),(0,t.jsx)("button",{onClick:()=>p(!0),className:"p-2 text-stone-400 hover:text-stone-600 hover:bg-stone-100 rounded-lg transition-colors",children:(0,t.jsx)(c,{className:"w-4 h-4"})})]})]}),n&&(0,t.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[(0,t.jsx)(J,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-red-800",children:n}),(0,t.jsx)("button",{onClick:()=>p(!0),className:"text-sm text-red-600 hover:text-red-800 mt-1 underline",children:"检查配置"})]})]}),l?(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-stone-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-5 border-b border-stone-100",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-stone-500",children:[l.date," 的评价"]}),(0,t.jsx)("h3",{className:"text-xl font-bold text-stone-800 mt-1",children:l.summary})]}),(0,t.jsxs)("div",{className:`px-3 py-1.5 rounded-full flex items-center gap-1.5 ${G[l.mood].color}`,children:[(h=G[l.mood].icon,(0,t.jsx)(h,{className:"w-4 h-4"})),(0,t.jsx)("span",{className:"text-sm font-medium",children:G[l.mood].label})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 h-2 bg-stone-100 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-purple-500 rounded-full transition-all",style:{width:`${l.score}%`}})}),(0,t.jsxs)("span",{className:"text-sm font-medium text-stone-700",children:[l.score,"分"]})]})]}),(0,t.jsxs)("div",{className:"p-5 space-y-4",children:[(0,t.jsx)("p",{className:"text-stone-700 leading-relaxed",children:l.detailedReview}),l.highlights.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:l.highlights.map((e,s)=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm",children:[(0,t.jsx)(O,{className:"w-3.5 h-3.5"}),e]},s))}),l.suggestions.length>0&&(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-xl",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(K,{className:"w-4 h-4 text-blue-500 mt-0.5"}),(0,t.jsx)("div",{className:"space-y-1",children:l.suggestions.map((e,s)=>(0,t.jsx)("p",{className:"text-sm text-blue-800",children:e},s))})]})})]}),(0,t.jsxs)("div",{className:"px-5 py-3 bg-stone-50 border-t border-stone-100 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-xs text-stone-400",children:["使用 ",e.provider," / ",e.model]}),(0,t.jsxs)("button",{onClick:x,className:"flex items-center gap-1.5 text-sm text-stone-600 hover:text-stone-800 transition-colors",children:[(0,t.jsx)(U,{className:"w-4 h-4"}),"重新分析"]})]})]}):(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-stone-200 p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,t.jsx)(H,{label:"完成率",value:`${a.completionRate}%`,color:"green"}),(0,t.jsx)(H,{label:"重要任务",value:`${a.highImportance.completed}/${a.highImportance.total}`,color:"blue"}),(0,t.jsx)(H,{label:"困难任务",value:`${a.highDifficulty.completed}/${a.highDifficulty.total}`,color:"purple"})]}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsx)(Q,{label:"总体完成",completed:a.completedTasks,total:a.totalTasks,color:"green"}),(0,t.jsx)(Q,{label:"高重要度任务",completed:a.highImportance.completed,total:a.highImportance.total,color:"blue"}),(0,t.jsx)(Q,{label:"高难度任务",completed:a.highDifficulty.completed,total:a.highDifficulty.total,color:"purple"})]}),(0,t.jsxs)("button",{onClick:m,className:"w-full py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-xl font-medium hover:from-purple-600 hover:to-blue-600 transition-all flex items-center justify-center gap-2 shadow-lg shadow-purple-200",children:[(0,t.jsx)(d,{className:"w-5 h-5"}),"让 AI 教练分析今日表现"]})]}),g&&o.reviews.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-stone-200 p-5",children:[(0,t.jsxs)("h3",{className:"font-semibold text-stone-800 mb-4 flex items-center gap-2",children:[(0,t.jsx)(T,{className:"w-4 h-4"}),"历史评价"]}),(0,t.jsx)("div",{className:"space-y-3",children:o.reviews.slice().reverse().map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-stone-50 rounded-xl hover:bg-stone-100 transition-colors",children:[(0,t.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${G[e.mood].color}`,children:(0,t.jsx)("span",{className:"text-sm font-bold",children:e.score})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-stone-800",children:e.summary}),(0,t.jsx)("p",{className:"text-xs text-stone-500",children:e.date})]}),(0,t.jsx)(L,{className:"w-4 h-4 text-stone-400"})]},e.date))})]}),(0,t.jsx)(_,{isOpen:u,onClose:()=>p(!1),onSave:i,existingConfig:e})]}):(0,t.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-2xl border border-purple-200 p-6",children:[(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto shadow-sm",children:(0,t.jsx)(d,{className:"w-8 h-8 text-purple-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-stone-800",children:"开启你的 AI 养成教练"}),(0,t.jsx)("p",{className:"text-sm text-stone-500 mt-2 max-w-sm mx-auto",children:"AI 教练会每天分析你的任务完成情况，给出温暖的反馈和建议，帮助你养成 J 人特质"})]}),(0,t.jsx)("button",{onClick:()=>p(!0),className:"px-6 py-2.5 bg-stone-800 text-white rounded-lg font-medium hover:bg-stone-700 transition-colors",children:"配置 AI 教练"})]}),(0,t.jsx)(_,{isOpen:u,onClose:()=>p(!1),onSave:i})]})}function Y(){let[e,l]=(0,s.useState)("execute"),[a,o]=(0,s.useState)(!1),{actionItems:r,sortedTasks:n,todayTasks:g,isLoaded:b,addActionItem:f,updateActionItem:y,deleteActionItem:j,startTask:v,completeTaskWithDuration:N,completeTaskSimple:k,cancelTask:C}=function(){let{value:e,setValue:t,isLoaded:l}=x("checklist-app-v1",{actionItems:[],todayTasks:[],currentDate:h()}),[a,o]=(0,s.useState)(e);(0,s.useEffect)(()=>{if(!l)return;let s=h();if(e.currentDate!==s){let l={actionItems:e.actionItems,todayTasks:e.actionItems.map(e=>u(e.id)),currentDate:s};o(l),t(l)}else o(e)},[e,l,t]);let r=(0,s.useCallback)((e,s,l,a,r)=>{let n={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e.trim(),difficulty:s,importance:l,timesPerDay:Math.max(1,a),hasDuration:r,createdAt:Date.now()};o(e=>{let s={...e,actionItems:[...e.actionItems,n],todayTasks:[...e.todayTasks,u(n.id)]};return t(s),s})},[t]),n=(0,s.useCallback)((e,s)=>{o(l=>{let a=l.actionItems.map(t=>t.id===e?{...t,...s}:t),o=l.todayTasks.find(t=>t.actionId===e),r=l.todayTasks;o&&(void 0!==s.timesPerDay||void 0!==s.hasDuration)&&(r=l.todayTasks.map(t=>t.actionId===e?u(e):t));let n={...l,actionItems:a,todayTasks:r};return t(n),n})},[t]),i=(0,s.useCallback)(e=>{o(s=>{let l={...s,actionItems:s.actionItems.filter(t=>t.id!==e),todayTasks:s.todayTasks.filter(t=>t.actionId!==e)};return t(l),l})},[t]),c=(0,s.useCallback)(e=>{o(s=>{let l=s.todayTasks.map(t=>{if(t.actionId!==e)return t;let s={startTime:Date.now(),endTime:null,duration:0};return{...t,currentExecution:s,lastUpdated:Date.now()}}),a={...s,todayTasks:l};return t(a),a})},[t]),d=(0,s.useCallback)(e=>{o(s=>{let l=s.todayTasks.map(t=>{if(t.actionId!==e||!t.currentExecution?.startTime)return t;let l=Date.now(),a=l-t.currentExecution.startTime,o={...t.currentExecution,endTime:l,duration:a},r=s.actionItems.find(t=>t.id===e),n=r?.timesPerDay||1,i=t.completedCount+1;return{...t,completedCount:i,currentExecution:null,executions:[...t.executions,o],isCompletedToday:i>=n,lastUpdated:Date.now()}}),a={...s,todayTasks:l};return t(a),a})},[t]),m=(0,s.useCallback)(e=>{o(s=>{let l=s.todayTasks.map(t=>{if(t.actionId!==e)return t;let l=s.actionItems.find(t=>t.id===e),a=l?.timesPerDay||1,o=t.completedCount+1;return{...t,completedCount:o,isCompletedToday:o>=a,lastUpdated:Date.now()}}),a={...s,todayTasks:l};return t(a),a})},[t]),p=(0,s.useCallback)(e=>{o(s=>{let l=s.todayTasks.map(t=>t.actionId!==e?t:{...t,currentExecution:null,lastUpdated:Date.now()}),a={...s,todayTasks:l};return t(a),a})},[t]),g=(0,s.useMemo)(()=>{let e={high:3,medium:2,low:1};return[...a.todayTasks].sort((t,s)=>{let l=a.actionItems.find(e=>e.id===t.actionId),o=a.actionItems.find(e=>e.id===s.actionId);if(!l||!o)return 0;if(t.isCompletedToday!==s.isCompletedToday)return t.isCompletedToday?1:-1;let r=e[o.importance]-e[l.importance];return 0!==r?r:l.createdAt-o.createdAt}).map(e=>({task:e,actionItem:a.actionItems.find(t=>t.id===e.actionId)})).filter(({actionItem:e})=>void 0!==e)},[a.todayTasks,a.actionItems]);return{actionItems:a.actionItems,todayTasks:a.todayTasks,sortedTasks:g,isLoaded:l,addActionItem:r,updateActionItem:n,deleteActionItem:i,startTask:c,completeTaskWithDuration:d,completeTaskSimple:m,cancelTask:p}}(),{config:I,todayReview:$,todayStats:M,history:T,isAnalyzing:D,error:A,saveConfig:S,analyze:E,clearTodayReview:z}=function(e,t,l){let{value:a,setValue:o}=x("checkup-agent-v1",{config:null,todayReview:null,history:{reviews:[],stats:[]},isAnalyzing:!1,error:null}),r=(0,s.useMemo)(()=>{let s,a,o;return s={date:l,totalTasks:e.length,completedTasks:0,completionRate:0,highImportance:{total:0,completed:0},mediumImportance:{total:0,completed:0},lowImportance:{total:0,completed:0},highDifficulty:{total:0,completed:0},mediumDifficulty:{total:0,completed:0},lowDifficulty:{total:0,completed:0},totalDuration:0,averageDuration:0},a=0,o=0,e.forEach(e=>{let l=t.find(t=>t.actionId===e.id);if(!l)return;let r=l.isCompletedToday;r&&s.completedTasks++;let n=`${e.importance}Importance`;s[n].total++,r&&s[n].completed++;let i=`${e.difficulty}Difficulty`;s[i].total++,r&&s[i].completed++,l.executions.length>0&&l.executions.forEach(e=>{e.duration>0&&(a+=e.duration,o++)})}),s.completionRate=s.totalTasks>0?Math.round(s.completedTasks/s.totalTasks*100):0,s.totalDuration=a,s.averageDuration=o>0?Math.round(a/o):0,s},[l,e,t]),n=(0,s.useCallback)(e=>{o(t=>({...t,config:e}))},[o]),i=(0,s.useCallback)(()=>{o(e=>({...e,config:null}))},[o]),c=(0,s.useCallback)(async()=>{if(!a.config)return void o(e=>({...e,error:"请先配置 AI"}));o(e=>({...e,isAnalyzing:!0,error:null}));try{let e,t=function(e,t){let s=t.reviews.slice(-7),l=`你是一位专业的习惯养成教练和心理咨询师。请根据用户今天的任务完成数据，给出温暖、鼓励但真诚的反馈。

## 今日任务数据 (${e.date})

### 总体完成情况
- 总任务数: ${e.totalTasks}
- 已完成: ${e.completedTasks}
- 完成率: ${e.completionRate}%

### 重要度完成情况
- 高重要度: ${e.highImportance.completed}/${e.highImportance.total} 完成
- 中重要度: ${e.mediumImportance.completed}/${e.mediumImportance.total} 完成
- 低重要度: ${e.lowImportance.completed}/${e.lowImportance.total} 完成

### 难度完成情况
- 高难度: ${e.highDifficulty.completed}/${e.highDifficulty.total} 完成
- 中难度: ${e.mediumDifficulty.completed}/${e.mediumDifficulty.total} 完成
- 低难度: ${e.lowDifficulty.completed}/${e.lowDifficulty.total} 完成
`;if(e.totalDuration>0){let t=Math.floor(e.totalDuration/36e5),s=Math.floor(e.totalDuration%36e5/6e4);l+=`
### 专注时间
- 总专注时长: ${t}小时${s}分钟
`}return s.length>0&&(l+=`
### 历史表现回顾
`,s.forEach(e=>{l+=`- ${e.date}: ${e.summary} (评分: ${e.score})
`})),l+=`
## 请输出以下格式的 JSON 回复：

{
  "summary": "一句话总结今天（20字以内，温暖幽默的风格）",
  "detailedReview": "详细评价（200-300字，分析今天的表现，结合历史对比，给予鼓励或建议）",
  "highlights": ["亮点1", "亮点2"],
  "suggestions": ["建议1"],
  "mood": "excellent/good/average/poor 之一",
  "score": 0-100的数字评分
}

注意：
1. 语气要像朋友一样温暖自然，不要太官方
2. 如果完成率高，要真心庆祝；如果完成率低，要理解并鼓励，不要批评
3. highlights 和 suggestions 各 1-2 条即可
4. 如果有历史数据，可以适当对比进步或退步
`}(r,a.history),s=await p(a.config,t);try{let t=s.match(/\{[\s\S]*\}/);if(t){let a=JSON.parse(t[0]);e={date:l,summary:a.summary||"今天也是努力的一天！",detailedReview:a.detailedReview||s,highlights:a.highlights||[],suggestions:a.suggestions||[],mood:a.mood||"good",score:a.score||70}}else throw Error("无法解析 AI 响应")}catch(t){e={date:l,summary:"今天也是努力的一天！",detailedReview:s,highlights:[],suggestions:[],mood:"good",score:70}}let n={reviews:[...a.history.reviews.filter(e=>e.date!==l),e],stats:[...a.history.stats.filter(e=>e.date!==l),r]};o(t=>({...t,todayReview:e,history:n,isAnalyzing:!1}))}catch(e){o(t=>({...t,isAnalyzing:!1,error:e instanceof Error?e.message:"未知错误"}))}},[a.config,a.history,r,l,o]),d=(0,s.useCallback)(()=>{o(e=>({...e,todayReview:null,error:null}))},[o]);return{...a,todayStats:r,saveConfig:n,clearConfig:i,analyze:c,clearTodayReview:d}}(r,g,new Date().toISOString().split("T")[0]);return((0,s.useEffect)(()=>{o(!0)},[]),a&&b)?(0,t.jsxs)("div",{className:"min-h-screen bg-stone-50",children:[(0,t.jsx)("header",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-stone-200",children:(0,t.jsx)("div",{className:"max-w-md mx-auto px-4 py-3 flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-stone-800 rounded-lg flex items-center justify-center",children:(0,t.jsx)(d,{className:"w-4 h-4 text-white"})}),(0,t.jsx)("h1",{className:"font-bold text-stone-800",children:"J人养成器"})]})})}),(0,t.jsxs)("main",{className:"max-w-md mx-auto px-4 py-4 pb-24",children:["execute"===e&&(0,t.jsx)(q,{sortedTasks:n,onStart:v,onCompleteWithDuration:N,onCompleteSimple:k,onCancel:C}),"manage"===e&&(0,t.jsx)(w,{actionItems:r,onAdd:f,onUpdate:y,onDelete:j}),"checkup"===e&&(0,t.jsx)(X,{config:I,todayReview:$,todayStats:M,history:T,isAnalyzing:D,error:A,onSaveConfig:S,onAnalyze:E,onClearReview:z})]}),(0,t.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-stone-200 safe-area-pb",children:(0,t.jsx)("div",{className:"max-w-md mx-auto px-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsxs)("button",{onClick:()=>l("execute"),className:`flex-1 flex flex-col items-center py-3 transition-colors ${"execute"===e?"text-stone-800":"text-stone-400 hover:text-stone-600"}`,children:[(0,t.jsx)(i,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"执行任务"})]}),(0,t.jsxs)("button",{onClick:()=>l("checkup"),className:`flex-1 flex flex-col items-center py-3 transition-colors ${"checkup"===e?"text-purple-600":"text-stone-400 hover:text-purple-500"}`,children:[(0,t.jsx)(m,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"AI教练"})]}),(0,t.jsxs)("button",{onClick:()=>l("manage"),className:`flex-1 flex flex-col items-center py-3 transition-colors ${"manage"===e?"text-stone-800":"text-stone-400 hover:text-stone-600"}`,children:[(0,t.jsx)(c,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"管理"})]})]})})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-stone-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-3 border-stone-300 border-t-stone-800 rounded-full animate-spin"}),(0,t.jsx)("p",{className:"text-sm text-stone-500",children:"加载中..."})]})})}e.s(["App",()=>Y],9843)}]);