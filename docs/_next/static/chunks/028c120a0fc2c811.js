(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9843,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let s=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),l=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:c,iconNode:n,...i},m)=>(0,a.createElement)("svg",{ref:m,...r,width:t,height:t,stroke:e,strokeWidth:o?24*Number(l)/Number(t):l,className:s("lucide",d),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(i)&&{"aria-hidden":"true"},...i},[...n.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(c)?c:[c]])),d=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...d},c)=>(0,a.createElement)(o,{ref:c,iconNode:t,className:s(`lucide-${l(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...d}));return r.displayName=l(e),r},c=d("sprout",[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]]),n=d("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),i=d("message-circle-heart",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}],["path",{d:"M7.828 13.07A3 3 0 0 1 12 8.764a3 3 0 0 1 5.004 2.224 3 3 0 0 1-.832 2.083l-3.447 3.62a1 1 0 0 1-1.45-.001z",key:"hoo97p"}]]);function m(e,t){let[s,l]=(0,a.useState)(t),[r,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{try{let t=window.localStorage.getItem(e);t&&l(JSON.parse(t))}catch(t){console.warn(`Error reading localStorage key "${e}":`,t)}o(!0)},[e]);let d=(0,a.useCallback)(t=>{try{let a=t instanceof Function?t(s):t;l(a),window.localStorage.setItem(e,JSON.stringify(a))}catch(t){console.warn(`Error setting localStorage key "${e}":`,t)}},[e,s]);return{value:s,setValue:d,removeValue:(0,a.useCallback)(()=>{try{l(t),window.localStorage.removeItem(e)}catch(t){console.warn(`Error removing localStorage key "${e}":`,t)}},[e,t]),isLoaded:r}}function x(){return new Date().toISOString().split("T")[0]}function h(e){return{actionId:e,completedCount:0,currentExecution:null,isCompletedToday:!1,executions:[],lastUpdated:Date.now()}}async function b(e,t){let a,s,l={"Content-Type":"application/json"};switch(e.provider){case"openai":a="https://api.openai.com/v1/chat/completions",l.Authorization=`Bearer ${e.apiKey}`,s={model:e.model||"gpt-4o-mini",messages:[{role:"user",content:t}],temperature:.7};break;case"anthropic":a="https://api.anthropic.com/v1/messages",l["x-api-key"]=e.apiKey,l["anthropic-version"]="2023-06-01",s={model:e.model||"claude-3-5-sonnet-20241022",max_tokens:1024,messages:[{role:"user",content:t}]};break;case"moonshot":a="https://api.moonshot.cn/v1/chat/completions",l.Authorization=`Bearer ${e.apiKey.trim()}`,s={model:e.model||"moonshot-v1-8k",messages:[{role:"user",content:t}],temperature:.7};break;case"zhipu":a="https://open.bigmodel.cn/api/paas/v4/chat/completions",l.Authorization=`Bearer ${e.apiKey}`,s={model:e.model||"glm-4-flash",messages:[{role:"user",content:t}],temperature:.7};break;case"custom":a=e.apiUrl||"",l.Authorization=`Bearer ${e.apiKey}`,s={model:e.model,messages:[{role:"user",content:t}],temperature:.7};break;default:throw Error("不支持的 AI 提供商")}let r=await fetch(a,{method:"POST",headers:l,body:JSON.stringify(s)});if(!r.ok){let e=await r.text(),t="API 调用失败";try{let a=JSON.parse(e);t=a.error?.message?.includes("Authentication")||a.error?.type?.includes("authentication")?"API Key 验证失败。可能原因：\n1. Key 复制不完整（检查是否以 sk- 开头）\n2. 浏览器跨域限制（需要使用代理）\n3. Key 确实无效":a.error?.message?a.error.message:JSON.stringify(a)}catch{t=e||`HTTP ${r.status}: ${r.statusText}`}throw Error(t)}let o=await r.json();return"anthropic"===e.provider?o.content?.[0]?.text||"":o.choices?.[0]?.message?.content||""}let u=d("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),p=d("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),f=d("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),g=d("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),j=d("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),y=d("shovel",[["path",{d:"M21.56 4.56a1.5 1.5 0 0 1 0 2.122l-.47.47a3 3 0 0 1-4.212-.03 3 3 0 0 1 0-4.243l.44-.44a1.5 1.5 0 0 1 2.121 0z",key:"1gcedi"}],["path",{d:"M3 22a1 1 0 0 1-1-1v-3.586a1 1 0 0 1 .293-.707l3.355-3.355a1.205 1.205 0 0 1 1.704 0l3.296 3.296a1.205 1.205 0 0 1 0 1.704l-3.355 3.355a1 1 0 0 1-.707.293z",key:"pg9kv3"}],["path",{d:"m9 15 7.879-7.878",key:"1o1zgh"}]]),v=d("axe",[["path",{d:"m14 12-8.381 8.38a1 1 0 0 1-3.001-3L11 9",key:"5z9253"}],["path",{d:"M15 15.5a.5.5 0 0 0 .5.5A6.5 6.5 0 0 0 22 9.5a.5.5 0 0 0-.5-.5h-1.672a2 2 0 0 1-1.414-.586l-5.062-5.062a1.205 1.205 0 0 0-1.704 0L9.352 5.648a1.205 1.205 0 0 0 0 1.704l5.062 5.062A2 2 0 0 1 15 13.828z",key:"19zklq"}]]),N=d("pickaxe",[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3L11 9.999",key:"1lw9ds"}],["path",{d:"M15.973 4.027A13 13 0 0 0 5.902 2.373c-1.398.342-1.092 2.158.277 2.601a19.9 19.9 0 0 1 5.822 3.024",key:"ffj4ej"}],["path",{d:"M16.001 11.999a19.9 19.9 0 0 1 3.024 5.824c.444 1.369 2.26 1.676 2.603.278A13 13 0 0 0 20 8.069",key:"8tj4zw"}],["path",{d:"M18.352 3.352a1.205 1.205 0 0 0-1.704 0l-5.296 5.296a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l5.296-5.296a1.205 1.205 0 0 0 0-1.704z",key:"hh6h97"}]]),w=d("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),k=d("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),C=[{value:"low",label:"轻松活",icon:y,color:"bg-green-100 text-green-700 border-green-300",desc:"顺手就能干"},{value:"medium",label:"费点劲",icon:v,color:"bg-yellow-100 text-yellow-700 border-yellow-300",desc:"得使点劲"},{value:"high",label:"苦力活",icon:N,color:"bg-red-100 text-red-700 border-red-300",desc:"大工程啊"}],M=[{value:"low",label:"随便搞搞",hearts:1,color:"bg-stone-100 text-stone-600 border-stone-300"},{value:"medium",label:"得重视",hearts:2,color:"bg-blue-100 text-blue-700 border-blue-300"},{value:"high",label:"很重要",hearts:3,color:"bg-purple-100 text-purple-700 border-purple-300"}];function $({actionItems:e,onAdd:s,onUpdate:l,onDelete:r}){let[o,d]=(0,a.useState)(!1),[c,i]=(0,a.useState)(null),[m,x]=(0,a.useState)(""),[h,b]=(0,a.useState)("medium"),[y,v]=(0,a.useState)("medium"),[N,$]=(0,a.useState)(1),[I,T]=(0,a.useState)(!1),S=()=>{x(""),b("medium"),v("medium"),$(1),T(!1)},D=o||null!==c;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n,{className:"w-6 h-6 text-[#6090c0]"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-[#5c4a32]",children:"当个事儿办"})]}),(0,t.jsxs)("span",{className:"text-sm text-[#8b6914] bg-[#e8d4a2] px-3 py-1 rounded-full border border-[#b8a878]",children:[e.length," 个事儿"]})]}),!D&&(0,t.jsxs)("button",{onClick:()=>d(!0),className:"w-full py-4 px-4 border-2 border-dashed border-[#b8a878] rounded-xl text-[#8b6914] hover:border-[#90c040] hover:text-[#5c8a20] hover:bg-[#d4e8c0] transition-colors flex items-center justify-center gap-2 font-bold",children:[(0,t.jsx)(u,{className:"w-5 h-5"}),"加个事儿"]}),D&&(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-xl border-2 border-[#b8a878] p-4 space-y-4 shadow-md",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-1.5",children:"事儿叫啥名儿"}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),placeholder:"比如：给菜园浇水",className:"w-full px-3 py-2 bg-white border-2 border-[#b8a878] rounded-lg focus:outline-none focus:border-[#90c040] text-[#5c4a32] placeholder-[#a08060]",autoFocus:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-1.5",children:"这活儿累不累"}),(0,t.jsx)("div",{className:"flex gap-2",children:C.map(e=>(0,t.jsxs)("button",{onClick:()=>b(e.value),className:`flex-1 py-2 px-1 rounded-lg border-2 text-sm font-bold transition-all ${h===e.value?`${e.color} ring-2 ring-offset-1 ring-[#8b6914]`:"bg-[#e8d4a2] text-[#5c4a32] border-[#b8a878] hover:bg-[#d4c494]"}`,title:e.desc,children:[(0,t.jsx)(e.icon,{className:"w-4 h-4 mx-auto mb-1"}),e.label]},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-1.5",children:"这事儿多重要"}),(0,t.jsx)("div",{className:"flex gap-2",children:M.map(e=>(0,t.jsxs)("button",{onClick:()=>v(e.value),className:`flex-1 py-2 px-1 rounded-lg border-2 text-sm font-bold transition-all ${y===e.value?`${e.color} ring-2 ring-offset-1 ring-[#8b6914]`:"bg-[#e8d4a2] text-[#5c4a32] border-[#b8a878] hover:bg-[#d4c494]"}`,children:[(0,t.jsx)("div",{className:"flex justify-center gap-0.5 mb-1",children:Array.from({length:e.hearts}).map((e,a)=>(0,t.jsx)(w,{className:"w-3 h-3 fill-current"},a))}),e.label]},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-1.5",children:"一天得干几回"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 bg-[#e8d4a2] rounded-lg p-2 border-2 border-[#b8a878]",children:[(0,t.jsx)("button",{onClick:()=>$(Math.max(1,N-1)),className:"w-10 h-10 rounded-lg border-2 border-[#8b6914] bg-[#f8f0d8] flex items-center justify-center hover:bg-[#d4e8c0] transition-colors font-bold text-[#5c4a32]",children:"-"}),(0,t.jsx)("span",{className:"w-16 text-center text-xl font-bold text-[#5c4a32]",children:N}),(0,t.jsx)("button",{onClick:()=>$(N+1),className:"w-10 h-10 rounded-lg border-2 border-[#8b6914] bg-[#f8f0d8] flex items-center justify-center hover:bg-[#d4e8c0] transition-colors font-bold text-[#5c4a32]",children:"+"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-1.5",children:"得掐着点儿不？"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>T(!1),className:`flex-1 py-2.5 px-4 rounded-lg border-2 text-sm font-bold transition-colors ${!I?"bg-[#90c040] text-white border-[#5c8a20]":"bg-[#e8d4a2] text-[#5c4a32] border-[#b8a878]"}`,children:"不用，干完就行"}),(0,t.jsx)("button",{onClick:()=>T(!0),className:`flex-1 py-2.5 px-4 rounded-lg border-2 text-sm font-bold transition-colors ${I?"bg-[#6090c0] text-white border-[#305070]":"bg-[#e8d4a2] text-[#5c4a32] border-[#b8a878]"}`,children:"得记个时"})]}),(0,t.jsx)("p",{className:"mt-1.5 text-xs text-[#8b6914]",children:I?'到时候得点"开干"和"收工"来记时间':'到时候点"干完"就行'})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsxs)("button",{onClick:()=>{i(null),d(!1),S()},className:"flex-1 py-2.5 px-4 border-2 border-[#8b6914] rounded-lg text-[#5c4a32] hover:bg-[#e8d4a2] transition-colors flex items-center justify-center gap-1.5 font-bold",children:[(0,t.jsx)(g,{className:"w-4 h-4"}),"算了"]}),(0,t.jsxs)("button",{onClick:c?()=>{c&&m.trim()&&(l(c,{name:m.trim(),difficulty:h,importance:y,timesPerDay:N,hasDuration:I}),i(null),S())}:()=>{m.trim()&&(s(m.trim(),h,y,N,I),S(),d(!1))},disabled:!m.trim(),className:"flex-1 py-2.5 px-4 bg-[#90c040] text-white rounded-lg hover:bg-[#7ab030] disabled:bg-[#c4b494] disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-1.5 font-bold border-2 border-[#5c8a20]",children:[(0,t.jsx)(j,{className:"w-4 h-4"}),c?"存好":"加上"]})]})]}),e.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>{let a,s;return(0,t.jsx)("div",{className:"bg-[#f8f0d8] rounded-xl border-2 border-[#b8a878] p-4 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-bold text-[#5c4a32] truncate",children:e.name}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[(a=C.find(t=>t.value===e.difficulty))?(0,t.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${a.color}`,children:[(0,t.jsx)(a.icon,{className:"w-3 h-3"}),a.label]}):null,(s=M.find(t=>t.value===e.importance))?(0,t.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-bold ${s.color}`,children:[(0,t.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:s.hearts}).map((e,a)=>(0,t.jsx)(w,{className:"w-3 h-3 fill-current"},a))}),s.label]}):null,(0,t.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-[#e8d4a2] text-[#5c4a32] border border-[#b8a878]",children:[(0,t.jsx)(k,{className:"w-3 h-3 mr-1"}),e.timesPerDay,"回/天"]}),e.hasDuration&&(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-bold bg-[#d0e0f0] text-[#305070] border border-[#6090c0]",children:"⏱ 计时"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 ml-2",children:[(0,t.jsx)("button",{onClick:()=>{i(e.id),x(e.name),b(e.difficulty),v(e.importance),$(e.timesPerDay),T(e.hasDuration)},className:"p-2 text-[#8b6914] hover:text-[#5c4a32] hover:bg-[#e8d4a2] rounded-lg transition-colors",children:(0,t.jsx)(f,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:"p-2 text-[#c07060] hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:(0,t.jsx)(p,{className:"w-4 h-4"})})]})]})},e.id)})}),0===e.length&&!o&&(0,t.jsxs)("div",{className:"text-center py-8 text-[#a08060]",children:[(0,t.jsx)(k,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,t.jsx)("p",{children:"还没啥事儿"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:"点上面按钮加个事儿吧"})]})]})}let I=d("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),T=d("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),S=d("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),D=d("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]),A=d("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),z={low:y,medium:v,high:N},E={low:"text-green-600 bg-green-100",medium:"text-yellow-600 bg-yellow-100",high:"text-red-600 bg-red-100"},R={low:1,medium:2,high:3};function P(e){let t=Math.floor(e/1e3),a=Math.floor(t/60),s=Math.floor(a/60);return s>0?`${s}时${a%60}分`:a>0?`${a}分${t%60}秒`:`${t}秒`}function O({current:e,max:a}){let s=Math.min(100,e/a*100),l=Math.ceil(a);return(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(w,{className:"w-4 h-4 text-red-500 fill-red-500"}),(0,t.jsx)("div",{className:"flex-1 h-3 bg-[#3d2914] rounded-full overflow-hidden border border-[#5c4a32]",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-red-400 to-red-500 transition-all duration-500",style:{width:`${s}%`}})}),(0,t.jsxs)("span",{className:"text-xs font-bold text-[#5c4a32] min-w-[2.5rem] text-right",children:[e,"/",a]})]}),(0,t.jsx)("div",{className:"flex gap-1",children:Array.from({length:l}).map((a,s)=>(0,t.jsx)(w,{className:`w-3 h-3 transition-colors ${s<e?"text-red-500 fill-red-500":"text-[#c4b484]"}`},s))})]})}function q({task:e,actionItem:s,onStart:l,onCompleteWithDuration:r,onCompleteSimple:o,onCancel:d}){let c=e.currentExecution?.startTime!==null&&e.currentExecution?.endTime===null,[n,i]=(0,a.useState)(0),m=z[s.difficulty];if((0,a.useEffect)(()=>{if(!c||!e.currentExecution?.startTime)return void i(0);let t=setInterval(()=>{i(Date.now()-e.currentExecution.startTime)},1e3);return()=>clearInterval(t)},[c,e.currentExecution]),e.isCompletedToday){let a=e.executions.reduce((e,t)=>e+t.duration,0);return(0,t.jsx)("div",{className:"bg-[#d4e8c0] rounded-xl border-2 border-[#7a9a5a] p-4 opacity-80",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-[#90c040] rounded-lg flex items-center justify-center border-2 border-[#5c8a20] shadow-sm",children:(0,t.jsx)(S,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-[#5c4a32] line-through opacity-60",children:s.name}),(0,t.jsxs)("p",{className:"text-xs text-[#7a9a5a]",children:["干了 ",e.completedCount,"/",s.timesPerDay," 次",a>0&&` \xb7 用了 ${P(a)}`]})]})]}),(0,t.jsx)("span",{className:"text-lg",children:"✓"})]})})}return(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-xl border-2 border-[#b8a878] p-4 shadow-md",children:[(0,t.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-bold text-[#5c4a32] text-lg",children:s.name}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[(0,t.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold ${E[s.difficulty]} border border-[#8b6914]`,children:[(0,t.jsx)(m,{className:"w-3 h-3"}),"low"===s.difficulty?"轻松活":"medium"===s.difficulty?"费点劲":"苦力活"]}),(0,t.jsx)("span",{className:"inline-flex items-center gap-1 text-[#e07050]",children:Array.from({length:R[s.importance]}).map((e,a)=>(0,t.jsx)(w,{className:"w-4 h-4 fill-current"},a))}),s.hasDuration&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold text-[#6090c0] bg-[#d0e0f0] border border-[#305070]",children:[(0,t.jsx)(D,{className:"w-3 h-3"}),"计时的"]})]})]})}),s.timesPerDay>1&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(O,{current:e.completedCount,max:s.timesPerDay})}),c&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-[#f0d8a0] rounded-lg border-2 border-[#d4a574] animate-pulse",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-[#8b6914]",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-[#e07050] rounded-full"}),(0,t.jsx)("span",{className:"text-sm font-bold",children:"干着呢！"}),(0,t.jsx)("span",{className:"text-lg font-mono font-bold ml-auto text-[#5c4a32]",children:P(n)})]})}),(0,t.jsx)("div",{className:"flex gap-2",children:s.hasDuration?c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>d(s.id),className:"flex-1 py-2.5 px-4 border-2 border-[#8b6914] rounded-lg text-[#5c4a32] hover:bg-[#e8d4a2] transition-colors text-sm font-bold",children:"算了"}),(0,t.jsxs)("button",{onClick:()=>r(s.id),className:"flex-[2] py-2.5 px-4 bg-[#90c040] text-white rounded-lg hover:bg-[#7ab030] transition-colors border-2 border-[#5c8a20] shadow-md flex items-center justify-center gap-2 font-bold",children:[(0,t.jsx)(T,{className:"w-4 h-4 fill-current"}),"收工！"]})]}):(0,t.jsxs)("button",{onClick:()=>l(s.id),className:"w-full py-2.5 px-4 bg-[#6090c0] text-white rounded-lg hover:bg-[#5080b0] transition-colors border-2 border-[#305070] shadow-md flex items-center justify-center gap-2 font-bold",children:[(0,t.jsx)(I,{className:"w-4 h-4 fill-current"}),"开干！"]}):(0,t.jsxs)("button",{onClick:()=>o(s.id),className:"w-full py-2.5 px-4 bg-[#90c040] text-white rounded-lg hover:bg-[#7ab030] transition-colors border-2 border-[#5c8a20] shadow-md flex items-center justify-center gap-2 font-bold",children:[(0,t.jsx)(S,{className:"w-4 h-4"}),"干完！"]})})]})}function K({sortedTasks:e,onStart:s,onCompleteWithDuration:l,onCompleteSimple:r,onCancel:o}){let d=(0,a.useMemo)(()=>new Date().toISOString().split("T")[0],[]),n=(0,a.useMemo)(()=>{let t=e.length,a=e.filter(({task:e})=>e.isCompletedToday).length,s=e.filter(({task:e})=>e.currentExecution?.startTime&&!e.currentExecution?.endTime).length,l=t>0?Math.round(a/t*100):0;return{total:t,completed:a,inProgress:s,completionRate:l}},[e]);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c,{className:"w-6 h-6 text-[#5c8a20]"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-[#5c4a32]",children:"今儿的活儿"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-[#8b6914] bg-[#e8d4a2] px-3 py-1 rounded-full border border-[#b8a878]",children:[(0,t.jsx)(A,{className:"w-4 h-4"}),d]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsxs)("div",{className:"bg-[#90c040] rounded-xl border-2 border-[#5c8a20] p-3 text-center shadow-md",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-white drop-shadow-sm",children:n.completed}),(0,t.jsx)("p",{className:"text-xs text-[#d4f0b0] font-bold mt-0.5",children:"干完的"})]}),(0,t.jsxs)("div",{className:"bg-[#6090c0] rounded-xl border-2 border-[#305070] p-3 text-center shadow-md",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-white drop-shadow-sm",children:n.inProgress}),(0,t.jsx)("p",{className:"text-xs text-[#d0e0f0] font-bold mt-0.5",children:"干着的"})]}),(0,t.jsxs)("div",{className:"bg-[#e07050] rounded-xl border-2 border-[#a04030] p-3 text-center shadow-md",children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-white drop-shadow-sm",children:[n.completionRate,"%"]}),(0,t.jsx)("p",{className:"text-xs text-[#f8d0c8] font-bold mt-0.5",children:"J人百分比"})]})]}),e.length>0?(0,t.jsx)("div",{className:"space-y-3",children:e.map(({task:e,actionItem:a})=>(0,t.jsx)(q,{task:e,actionItem:a,onStart:s,onCompleteWithDuration:l,onCompleteSimple:r,onCancel:o},e.actionId))}):(0,t.jsxs)("div",{className:"text-center py-12 bg-[#e8d4a2] rounded-xl border-2 border-dashed border-[#b8a878]",children:[(0,t.jsx)(c,{className:"w-16 h-16 text-[#b8a878] mx-auto mb-3 opacity-60"}),(0,t.jsx)("p",{className:"text-[#8b6914] font-bold",children:"今儿没活儿干"}),(0,t.jsx)("p",{className:"text-sm text-[#a08060] mt-1",children:'去"当个事儿办"加几个事儿吧'})]})]})}let U=d("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),V=d("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),L=d("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),J=d("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),B=d("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),_=d("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),H=d("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),W=d("scroll",[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]),F=d("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]]),Z=d("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),G=d("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Q=d("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),X=d("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Y=d("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),ee=[{value:"moonshot",label:"Moonshot",models:["moonshot-v1-8k","moonshot-v1-32k","moonshot-v1-128k"],desc:"国内可用，推荐",hasCors:!1},{value:"zhipu",label:"智谱",models:["glm-4-flash","glm-4","glm-4-plus"],desc:"国产大模型",hasCors:!1},{value:"openai",label:"OpenAI",models:["gpt-4o-mini","gpt-4o","gpt-3.5-turbo"],desc:"需要梯子",hasCors:!1},{value:"anthropic",label:"Claude",models:["claude-3-5-sonnet-20241022","claude-3-opus-20240229"],desc:"需要梯子",hasCors:!1},{value:"custom",label:"自定义",models:["自定义模型"],desc:"其他API或代理",hasCors:!0}];function et({isOpen:e,onClose:s,onSave:l,existingConfig:r}){let[o,d]=(0,a.useState)(r?.provider||"moonshot"),[c,n]=(0,a.useState)(r?.apiKey||""),[i,m]=(0,a.useState)(r?.apiUrl||""),[x,h]=(0,a.useState)(r?.model||""),[b,u]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!1),[g,j]=(0,a.useState)(r?.apiUrl?.includes("cors")||!1),y=ee.find(e=>e.value===o),v=y?.models[0]||"";return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-fade-in",children:(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-2xl w-full max-w-md overflow-hidden shadow-xl border-2 border-[#8b6914]",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b-2 border-[#d4c494] flex items-center justify-between bg-[#e8d4a2]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(F,{className:"w-6 h-6 text-[#e07050]"}),(0,t.jsx)("h2",{className:"text-lg font-bold text-[#5c4a32]",children:"叫唠叨奶奶出来"})]}),(0,t.jsx)("button",{onClick:()=>f(!p),className:"p-2 text-[#8b6914] hover:text-[#5c4a32] hover:bg-[#d4c494] rounded-lg transition-colors",children:(0,t.jsx)(X,{className:"w-5 h-5"})})]}),p&&(0,t.jsxs)("div",{className:"px-6 py-4 bg-[#f0e8d0] border-b-2 border-[#d4c494] text-sm text-[#5c4a32]",children:[(0,t.jsx)("h4",{className:"font-bold mb-2",children:"为啥可能连不上？"}),(0,t.jsx)("p",{className:"mb-2",children:'浏览器有个叫"跨域"的限制，大部分 AI 服务（包括 Moonshot）都不让网页直接调用。'}),(0,t.jsx)("p",{className:"mb-2",children:(0,t.jsx)("strong",{children:"解决办法："})}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,t.jsx)("li",{children:"使用浏览器插件（如 CORS Unblock）"}),(0,t.jsx)("li",{children:'使用"自定义"模式填入代理地址'}),(0,t.jsx)("li",{children:"暂时使用智谱 AI（glm-4-flash 免费）"})]})]}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!c.trim())return;let t=i;g&&"custom"!==o&&(t="https://corsproxy.io/?https://api.moonshot.cn/v1/chat/completions"),l({provider:o,apiKey:c.trim(),apiUrl:t||void 0,model:x||v}),s()},className:"p-6 space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-2",children:"选个唠叨的渠道"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:ee.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>{d(e.value),h(e.models[0])},title:e.desc,className:`px-3 py-2 rounded-lg text-sm font-bold transition-all border-2 ${o===e.value?"bg-[#90c040] text-white border-[#5c8a20]":"bg-[#e8d4a2] text-[#5c4a32] border-[#b8a878] hover:bg-[#d4c494]"}`,children:e.label},e.value))}),(0,t.jsxs)("p",{className:"mt-2 text-xs text-[#8b6914]",children:[y?.desc,!y?.hasCors&&(0,t.jsx)("span",{className:"text-[#e07050] ml-1",children:"⚠️ 需要代理"})]})]}),"custom"!==o&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"useProxy",checked:g,onChange:e=>j(e.target.checked),className:"w-4 h-4 accent-[#90c040]"}),(0,t.jsx)("label",{htmlFor:"useProxy",className:"text-sm text-[#5c4a32] font-bold cursor-pointer",children:"使用 CORS 代理（不稳定，仅测试）"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-2",children:"钥匙（API Key）"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-[#8b6914]"}),(0,t.jsx)("input",{type:b?"text":"password",value:c,onChange:e=>n(e.target.value),placeholder:"把你的钥匙搁这儿",className:"w-full pl-10 pr-10 py-2.5 bg-white border-2 border-[#b8a878] rounded-lg focus:outline-none focus:border-[#90c040] text-[#5c4a32] placeholder-[#a08060]",required:!0}),(0,t.jsx)("button",{type:"button",onClick:()=>u(!b),className:"absolute right-3 top-1/2 -translate-y-1/2 text-[#8b6914] hover:text-[#5c4a32]",children:b?(0,t.jsx)(Q,{className:"w-5 h-5"}):(0,t.jsx)(G,{className:"w-5 h-5"})})]}),(0,t.jsx)("p",{className:"mt-1.5 text-xs text-[#8b6914]",children:"钥匙只存在你手机里，奶奶不会告诉别人"})]}),"custom"===o&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-2",children:"自定义地址"}),(0,t.jsx)("input",{type:"url",value:i,onChange:e=>m(e.target.value),placeholder:"https://api.example.com/v1/chat/completions",className:"w-full px-3 py-2.5 bg-white border-2 border-[#b8a878] rounded-lg focus:outline-none focus:border-[#90c040] text-[#5c4a32]",required:!0}),(0,t.jsx)("p",{className:"mt-1.5 text-xs text-[#8b6914]",children:"可以填入 CORS 代理地址，如 corsproxy.io"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-[#5c4a32] mb-2",children:"选个嗓门"}),(0,t.jsx)("select",{value:x||v,onChange:e=>h(e.target.value),className:"w-full px-3 py-2.5 bg-white border-2 border-[#b8a878] rounded-lg focus:outline-none focus:border-[#90c040] text-[#5c4a32]",children:y?.models.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]}),(0,t.jsxs)("button",{type:"submit",disabled:!c.trim(),className:"w-full py-3 bg-[#90c040] text-white rounded-xl font-bold hover:bg-[#7ab030] disabled:bg-[#c4b494] disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2 border-2 border-[#5c8a20] shadow-md",children:[(0,t.jsx)(F,{className:"w-5 h-5"}),"奶奶出来吧！"]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("a",{href:"moonshot"===o?"https://platform.moonshot.cn":"zhipu"===o?"https://open.bigmodel.cn":"openai"===o?"https://platform.openai.com":"anthropic"===o?"https://console.anthropic.com":"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-[#6090c0] hover:text-[#305070] font-bold",children:["去 ",y?.label," 搞个钥匙",(0,t.jsx)(Y,{className:"w-3 h-3"})]})})]})]})}):null}let ea={excellent:{label:"倍儿棒",color:"bg-[#90c040] text-white border-[#5c8a20]",icon:V},good:{label:"不赖",color:"bg-[#6090c0] text-white border-[#305070]",icon:U},average:{label:"还行",color:"bg-[#e0c040] text-[#5c4a32] border-[#b0a030]",icon:D},poor:{label:"得加油",color:"bg-[#e07050] text-white border-[#a04030]",icon:_}};function es({label:e,value:a,color:s="wood"}){return(0,t.jsxs)("div",{className:`p-3 rounded-xl border-2 ${{green:"bg-[#90c040] border-[#5c8a20]",blue:"bg-[#6090c0] border-[#305070]",red:"bg-[#e07050] border-[#a04030]",wood:"bg-[#d4a574] border-[#8b6914]"}[s]} text-center shadow-md`,children:[(0,t.jsx)("p",{className:"text-xs text-white/80 font-bold mb-1",children:e}),(0,t.jsx)("p",{className:"text-xl font-bold text-white drop-shadow-sm",children:a})]})}function el({label:e,completed:a,total:s,color:l="wood"}){let r=s>0?Math.round(a/s*100):0;return(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-[#5c4a32] font-bold",children:e}),(0,t.jsxs)("span",{className:"text-[#5c4a32] font-bold",children:[a,"/",s]})]}),(0,t.jsx)("div",{className:"h-3 bg-[#3d2914] rounded-full overflow-hidden border border-[#5c4a32]",children:(0,t.jsx)("div",{className:`h-full bg-gradient-to-r ${{green:"from-[#90c040] to-[#7ab030]",blue:"from-[#6090c0] to-[#5080b0]",purple:"from-[#9060c0] to-[#8050b0]",red:"from-[#e07050] to-[#d06040]",wood:"from-[#d4a574] to-[#c49464]"}[l]} transition-all duration-500 rounded-full`,style:{width:`${r}%`}})})]})}function er({config:e,todayReview:s,todayStats:l,history:r,isAnalyzing:o,error:d,onSaveConfig:c,onAnalyze:n,onClearReview:i}){let m,[x,h]=(0,a.useState)(!1),[b,u]=(0,a.useState)(!1);return e?o?(0,t.jsx)("div",{className:"bg-[#f8f0d8] rounded-2xl border-2 border-[#b8a878] p-8 shadow-md",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-[#b8a878] border-t-[#90c040] rounded-full animate-spin"}),(0,t.jsx)(F,{className:"w-8 h-8 text-[#8b6914] absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-[#5c4a32] font-bold text-lg",children:"唠叨奶奶正在琢磨..."}),(0,t.jsx)("p",{className:"text-sm text-[#8b6914] mt-1",children:"翻翻账本，看看你今天干得咋样"})]})]})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(F,{className:"w-7 h-7 text-[#e07050]"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-[#5c4a32]",children:"唠叨奶奶"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("button",{onClick:()=>u(!b),className:"px-3 py-1.5 text-sm text-[#5c4a32] font-bold hover:bg-[#e8d4a2] rounded-lg transition-colors border border-[#b8a878]",children:b?"收起账本":"翻翻旧账"})})]}),d&&(0,t.jsxs)("div",{className:"p-4 bg-[#f0d0c8] border-2 border-[#e07050] rounded-xl flex items-start gap-3",children:[(0,t.jsx)(H,{className:"w-5 h-5 text-[#a04030] flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-[#a04030] font-bold",children:d}),(0,t.jsx)("button",{onClick:()=>h(!0),className:"text-sm text-[#e07050] hover:text-[#a04030] mt-1 underline font-bold",children:"去修修"})]})]}),s?(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-2xl border-2 border-[#b8a878] overflow-hidden shadow-md",children:[(0,t.jsxs)("div",{className:"p-5 border-b-2 border-[#e8d4a2]",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-[#8b6914] font-bold",children:[s.date," 的唠叨"]}),(0,t.jsx)("h3",{className:"text-xl font-bold text-[#5c4a32] mt-1",children:s.summary})]}),(0,t.jsxs)("div",{className:`px-3 py-1.5 rounded-full flex items-center gap-1.5 border-2 ${ea[s.mood].color}`,children:[(m=ea[s.mood].icon,(0,t.jsx)(m,{className:"w-4 h-4"})),(0,t.jsx)("span",{className:"text-sm font-bold",children:ea[s.mood].label})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 h-3 bg-[#3d2914] rounded-full overflow-hidden border border-[#5c4a32]",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-[#90c040] to-[#7ab030] rounded-full transition-all",style:{width:`${s.score}%`}})}),(0,t.jsxs)("span",{className:"text-sm font-bold text-[#5c4a32]",children:[s.score,"分"]})]})]}),(0,t.jsxs)("div",{className:"p-5 space-y-4",children:[(0,t.jsx)("p",{className:"text-[#5c4a32] leading-relaxed font-medium",children:s.detailedReview}),s.highlights.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:s.highlights.map((e,a)=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-[#d4e8c0] text-[#5c8a20] rounded-full text-sm font-bold border border-[#7a9a5a]",children:[(0,t.jsx)(V,{className:"w-3.5 h-3.5"}),e]},a))}),s.suggestions.length>0&&(0,t.jsx)("div",{className:"p-3 bg-[#e0f0f8] rounded-xl border border-[#6090c0]",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(L,{className:"w-4 h-4 text-[#6090c0] mt-0.5"}),(0,t.jsx)("div",{className:"space-y-1",children:s.suggestions.map((e,a)=>(0,t.jsx)("p",{className:"text-sm text-[#305070] font-bold",children:e},a))})]})})]}),(0,t.jsxs)("div",{className:"px-5 py-3 bg-[#e8d4a2] border-t-2 border-[#d4c494] flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-xs text-[#8b6914] font-bold",children:["唠叨奶奶来自 ",e.provider]}),(0,t.jsxs)("button",{onClick:i,className:"flex items-center gap-1.5 text-sm text-[#5c4a32] hover:text-[#8b6914] transition-colors font-bold",children:[(0,t.jsx)(J,{className:"w-4 h-4"}),"再唠叨一遍"]})]})]}):(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-2xl border-2 border-[#b8a878] p-5 shadow-md",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,t.jsx)(es,{label:"J人百分比",value:`${l.completionRate}%`,color:"green"}),(0,t.jsx)(es,{label:"重要事儿",value:`${l.highImportance.completed}/${l.highImportance.total}`,color:"blue"}),(0,t.jsx)(es,{label:"苦力活",value:`${l.highDifficulty.completed}/${l.highDifficulty.total}`,color:"red"})]}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsx)(el,{label:"活儿进度",completed:l.completedTasks,total:l.totalTasks,color:"green"}),(0,t.jsx)(el,{label:"重要事儿进度",completed:l.highImportance.completed,total:l.highImportance.total,color:"blue"}),(0,t.jsx)(el,{label:"苦力活进度",completed:l.highDifficulty.completed,total:l.highDifficulty.total,color:"purple"})]}),(0,t.jsxs)("button",{onClick:n,className:"w-full py-3 bg-gradient-to-r from-[#e07050] to-[#d06040] text-white rounded-xl font-bold hover:from-[#d06040] hover:to-[#c05030] transition-all flex items-center justify-center gap-2 shadow-md border-2 border-[#a04030]",children:[(0,t.jsx)(F,{className:"w-5 h-5"}),"听奶奶唠叨两句"]})]}),b&&r.reviews.length>0&&(0,t.jsxs)("div",{className:"bg-[#f8f0d8] rounded-2xl border-2 border-[#b8a878] p-5 shadow-md",children:[(0,t.jsxs)("h3",{className:"font-bold text-[#5c4a32] mb-4 flex items-center gap-2",children:[(0,t.jsx)(W,{className:"w-5 h-5"}),"奶奶的唠叨本"]}),(0,t.jsx)("div",{className:"space-y-3",children:r.reviews.slice().reverse().map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-[#e8d4a2] rounded-xl hover:bg-[#d4c494] transition-colors border border-[#b8a878]",children:[(0,t.jsx)("div",{className:`w-12 h-12 rounded-full flex items-center justify-center border-2 ${ea[e.mood].color}`,children:(0,t.jsx)("span",{className:"text-sm font-bold",children:e.score})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-bold text-[#5c4a32]",children:e.summary}),(0,t.jsx)("p",{className:"text-xs text-[#8b6914]",children:e.date})]}),(0,t.jsx)(B,{className:"w-4 h-4 text-[#8b6914]"})]},e.date))})]}),(0,t.jsx)(et,{isOpen:x,onClose:()=>h(!1),onSave:c,existingConfig:e})]}):(0,t.jsxs)("div",{className:"bg-gradient-to-br from-[#f0d8a0] to-[#e8c080] rounded-2xl border-2 border-[#b8a878] p-6 shadow-md",children:[(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-[#f8f0d8] rounded-full flex items-center justify-center mx-auto border-4 border-[#8b6914] shadow-inner",children:(0,t.jsx)(F,{className:"w-10 h-10 text-[#8b6914]"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-[#5c4a32]",children:"叫唤你的唠叨奶奶"}),(0,t.jsxs)("p",{className:"text-sm text-[#8b6914] mt-2 max-w-sm mx-auto leading-relaxed",children:["唠叨奶奶虽然烦，但她会给你鼠粮。",(0,t.jsx)("br",{}),"她会每天瞅瞅你活儿干得咋样，",(0,t.jsx)("br",{}),"唠叨几句，再给点实在的鼓励。"]})]}),(0,t.jsx)("button",{onClick:()=>h(!0),className:"px-6 py-3 bg-[#90c040] text-white rounded-xl font-bold hover:bg-[#7ab030] transition-colors border-2 border-[#5c8a20] shadow-md",children:"叫奶奶出来"})]}),(0,t.jsx)(et,{isOpen:x,onClose:()=>h(!1),onSave:c})]})}function eo(){let[e,s]=(0,a.useState)("execute"),[l,r]=(0,a.useState)(!1),{actionItems:o,sortedTasks:d,todayTasks:u,isLoaded:p,addActionItem:f,updateActionItem:g,deleteActionItem:j,startTask:y,completeTaskWithDuration:v,completeTaskSimple:N,cancelTask:w}=function(){let{value:e,setValue:t,isLoaded:s}=m("checklist-app-v1",{actionItems:[],todayTasks:[],currentDate:x()}),[l,r]=(0,a.useState)(e);(0,a.useEffect)(()=>{if(!s)return;let a=x();if(e.currentDate!==a){let s={actionItems:e.actionItems,todayTasks:e.actionItems.map(e=>h(e.id)),currentDate:a};r(s),t(s)}else r(e)},[e,s,t]);let o=(0,a.useCallback)((e,a,s,l,o)=>{let d={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e.trim(),difficulty:a,importance:s,timesPerDay:Math.max(1,l),hasDuration:o,createdAt:Date.now()};r(e=>{let a={...e,actionItems:[...e.actionItems,d],todayTasks:[...e.todayTasks,h(d.id)]};return t(a),a})},[t]),d=(0,a.useCallback)((e,a)=>{r(s=>{let l=s.actionItems.map(t=>t.id===e?{...t,...a}:t),r=s.todayTasks.find(t=>t.actionId===e),o=s.todayTasks;r&&(void 0!==a.timesPerDay||void 0!==a.hasDuration)&&(o=s.todayTasks.map(t=>t.actionId===e?h(e):t));let d={...s,actionItems:l,todayTasks:o};return t(d),d})},[t]),c=(0,a.useCallback)(e=>{r(a=>{let s={...a,actionItems:a.actionItems.filter(t=>t.id!==e),todayTasks:a.todayTasks.filter(t=>t.actionId!==e)};return t(s),s})},[t]),n=(0,a.useCallback)(e=>{r(a=>{let s=a.todayTasks.map(t=>{if(t.actionId!==e)return t;let a={startTime:Date.now(),endTime:null,duration:0};return{...t,currentExecution:a,lastUpdated:Date.now()}}),l={...a,todayTasks:s};return t(l),l})},[t]),i=(0,a.useCallback)(e=>{r(a=>{let s=a.todayTasks.map(t=>{if(t.actionId!==e||!t.currentExecution?.startTime)return t;let s=Date.now(),l=s-t.currentExecution.startTime,r={...t.currentExecution,endTime:s,duration:l},o=a.actionItems.find(t=>t.id===e),d=o?.timesPerDay||1,c=t.completedCount+1;return{...t,completedCount:c,currentExecution:null,executions:[...t.executions,r],isCompletedToday:c>=d,lastUpdated:Date.now()}}),l={...a,todayTasks:s};return t(l),l})},[t]),b=(0,a.useCallback)(e=>{r(a=>{let s=a.todayTasks.map(t=>{if(t.actionId!==e)return t;let s=a.actionItems.find(t=>t.id===e),l=s?.timesPerDay||1,r=t.completedCount+1;return{...t,completedCount:r,isCompletedToday:r>=l,lastUpdated:Date.now()}}),l={...a,todayTasks:s};return t(l),l})},[t]),u=(0,a.useCallback)(e=>{r(a=>{let s=a.todayTasks.map(t=>t.actionId!==e?t:{...t,currentExecution:null,lastUpdated:Date.now()}),l={...a,todayTasks:s};return t(l),l})},[t]),p=(0,a.useMemo)(()=>{let e={high:3,medium:2,low:1};return[...l.todayTasks].sort((t,a)=>{let s=l.actionItems.find(e=>e.id===t.actionId),r=l.actionItems.find(e=>e.id===a.actionId);if(!s||!r)return 0;if(t.isCompletedToday!==a.isCompletedToday)return t.isCompletedToday?1:-1;let o=e[r.importance]-e[s.importance];return 0!==o?o:s.createdAt-r.createdAt}).map(e=>({task:e,actionItem:l.actionItems.find(t=>t.id===e.actionId)})).filter(({actionItem:e})=>void 0!==e)},[l.todayTasks,l.actionItems]);return{actionItems:l.actionItems,todayTasks:l.todayTasks,sortedTasks:p,isLoaded:s,addActionItem:o,updateActionItem:d,deleteActionItem:c,startTask:n,completeTaskWithDuration:i,completeTaskSimple:b,cancelTask:u}}(),{config:k,todayReview:C,todayStats:M,history:I,isAnalyzing:T,error:S,saveConfig:D,analyze:A,clearTodayReview:z}=function(e,t,s){let{value:l,setValue:r}=m("checkup-agent-v1",{config:null,todayReview:null,history:{reviews:[],stats:[]},isAnalyzing:!1,error:null}),o=(0,a.useMemo)(()=>{let a,l,r;return a={date:s,totalTasks:e.length,completedTasks:0,completionRate:0,highImportance:{total:0,completed:0},mediumImportance:{total:0,completed:0},lowImportance:{total:0,completed:0},highDifficulty:{total:0,completed:0},mediumDifficulty:{total:0,completed:0},lowDifficulty:{total:0,completed:0},totalDuration:0,averageDuration:0},l=0,r=0,e.forEach(e=>{let s=t.find(t=>t.actionId===e.id);if(!s)return;let o=s.isCompletedToday;o&&a.completedTasks++;let d=`${e.importance}Importance`;a[d].total++,o&&a[d].completed++;let c=`${e.difficulty}Difficulty`;a[c].total++,o&&a[c].completed++,s.executions.length>0&&s.executions.forEach(e=>{e.duration>0&&(l+=e.duration,r++)})}),a.completionRate=a.totalTasks>0?Math.round(a.completedTasks/a.totalTasks*100):0,a.totalDuration=l,a.averageDuration=r>0?Math.round(l/r):0,a},[s,e,t]),d=(0,a.useCallback)(e=>{let t={...e,apiKey:e.apiKey.trim()};r(e=>({...e,config:t,error:null}))},[r]),c=(0,a.useCallback)(()=>{r(e=>({...e,config:null}))},[r]),n=(0,a.useCallback)(async()=>{if(!l.config)return void r(e=>({...e,error:"请先配置 AI"}));r(e=>({...e,isAnalyzing:!0,error:null}));try{let e,t=function(e,t){let a=t.reviews.slice(-7),s=`你是一位专业的习惯养成教练和心理咨询师。请根据用户今天的任务完成数据，给出温暖、鼓励但真诚的反馈。

## 今日任务数据 (${e.date})

### 总体完成情况
- 总任务数: ${e.totalTasks}
- 已完成: ${e.completedTasks}
- 完成率: ${e.completionRate}%

### 重要度完成情况
- 高重要度: ${e.highImportance.completed}/${e.highImportance.total} 完成
- 中重要度: ${e.mediumImportance.completed}/${e.mediumImportance.total} 完成
- 低重要度: ${e.lowImportance.completed}/${e.lowImportance.total} 完成

### 难度完成情况
- 高难度: ${e.highDifficulty.completed}/${e.highDifficulty.total} 完成
- 中难度: ${e.mediumDifficulty.completed}/${e.mediumDifficulty.total} 完成
- 低难度: ${e.lowDifficulty.completed}/${e.lowDifficulty.total} 完成
`;if(e.totalDuration>0){let t=Math.floor(e.totalDuration/36e5),a=Math.floor(e.totalDuration%36e5/6e4);s+=`
### 专注时间
- 总专注时长: ${t}小时${a}分钟
`}return a.length>0&&(s+=`
### 历史表现回顾
`,a.forEach(e=>{s+=`- ${e.date}: ${e.summary} (评分: ${e.score})
`})),s+=`
## 请输出以下格式的 JSON 回复：

{
  "summary": "一句话总结今天（20字以内，温暖幽默的风格）",
  "detailedReview": "详细评价（200-300字，分析今天的表现，结合历史对比，给予鼓励或建议）",
  "highlights": ["亮点1", "亮点2"],
  "suggestions": ["建议1"],
  "mood": "excellent/good/average/poor 之一",
  "score": 0-100的数字评分
}

注意：
1. 语气要像朋友一样温暖自然，不要太官方
2. 如果完成率高，要真心庆祝；如果完成率低，要理解并鼓励，不要批评
3. highlights 和 suggestions 各 1-2 条即可
4. 如果有历史数据，可以适当对比进步或退步
`}(o,l.history),a=await b(l.config,t);try{let t=a.match(/\{[\s\S]*\}/);if(t){let l=JSON.parse(t[0]);e={date:s,summary:l.summary||"今天也是努力的一天！",detailedReview:l.detailedReview||a,highlights:l.highlights||[],suggestions:l.suggestions||[],mood:l.mood||"good",score:l.score||70}}else throw Error("无法解析 AI 响应")}catch(t){e={date:s,summary:"今天也是努力的一天！",detailedReview:a,highlights:[],suggestions:[],mood:"good",score:70}}let d={reviews:[...l.history.reviews.filter(e=>e.date!==s),e],stats:[...l.history.stats.filter(e=>e.date!==s),o]};r(t=>({...t,todayReview:e,history:d,isAnalyzing:!1}))}catch(e){r(t=>({...t,isAnalyzing:!1,error:e instanceof Error?e.message:"未知错误"}))}},[l.config,l.history,o,s,r]),i=(0,a.useCallback)(()=>{r(e=>({...e,todayReview:null,error:null}))},[r]);return{...l,todayStats:o,saveConfig:d,clearConfig:c,analyze:n,clearTodayReview:i}}(o,u,new Date().toISOString().split("T")[0]);return((0,a.useEffect)(()=>{r(!0)},[]),l&&p)?(0,t.jsxs)("div",{className:"min-h-screen bg-[#f4e4bc] pixel-font",children:[(0,t.jsx)("header",{className:"sticky top-0 z-10 bg-[#d4a574] border-b-4 border-[#8b6914] shadow-md",children:(0,t.jsx)("div",{className:"max-w-md mx-auto px-4 py-3 flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-[#8b6914] rounded-lg flex items-center justify-center border-2 border-[#5c4a32] shadow-inner",children:(0,t.jsx)(c,{className:"w-6 h-6 text-[#90c040]"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-bold text-[#5c4a32] text-lg tracking-wide drop-shadow-sm",children:"P人助手"}),(0,t.jsx)("p",{className:"text-xs text-[#8b6914]",children:"今天也要好好种地哦"})]})]})})}),(0,t.jsxs)("main",{className:"max-w-md mx-auto px-4 py-4 pb-28",children:["execute"===e&&(0,t.jsx)(K,{sortedTasks:d,onStart:y,onCompleteWithDuration:v,onCompleteSimple:N,onCancel:w}),"manage"===e&&(0,t.jsx)($,{actionItems:o,onAdd:f,onUpdate:g,onDelete:j}),"checkup"===e&&(0,t.jsx)(er,{config:k,todayReview:C,todayStats:M,history:I,isAnalyzing:T,error:S,onSaveConfig:D,onAnalyze:A,onClearReview:z})]}),(0,t.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-[#e8d4a2] border-t-4 border-[#8b6914] shadow-[0_-4px_0_rgba(0,0,0,0.1)] safe-area-pb",children:(0,t.jsx)("div",{className:"max-w-md mx-auto px-2 py-2",children:(0,t.jsxs)("div",{className:"flex bg-[#d4c494] rounded-xl p-1 border-2 border-[#8b6914]",children:[(0,t.jsxs)("button",{onClick:()=>s("execute"),className:`flex-1 flex flex-col items-center py-2 rounded-lg transition-all ${"execute"===e?"bg-[#90c040] text-white shadow-md border-2 border-[#5c8a20]":"text-[#5c4a32] hover:bg-[#c4b484]"}`,children:[(0,t.jsx)(c,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-bold",children:"今儿的活儿"})]}),(0,t.jsxs)("button",{onClick:()=>s("checkup"),className:`flex-1 flex flex-col items-center py-2 rounded-lg transition-all ${"checkup"===e?"bg-[#e07050] text-white shadow-md border-2 border-[#a04030]":"text-[#5c4a32] hover:bg-[#c4b484]"}`,children:[(0,t.jsx)(i,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-bold",children:"唠叨奶奶"})]}),(0,t.jsxs)("button",{onClick:()=>s("manage"),className:`flex-1 flex flex-col items-center py-2 rounded-lg transition-all ${"manage"===e?"bg-[#6090c0] text-white shadow-md border-2 border-[#305070]":"text-[#5c4a32] hover:bg-[#c4b484]"}`,children:[(0,t.jsx)(n,{className:"w-6 h-6 mb-0.5"}),(0,t.jsx)("span",{className:"text-xs font-bold",children:"当个事儿办"})]})]})})})]}):(0,t.jsx)("div",{className:"min-h-screen bg-[#f4e4bc] flex items-center justify-center pixel-font",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-[#8b6914] border-t-[#d4a574] rounded-full animate-spin"}),(0,t.jsx)("p",{className:"text-[#5c4a32] text-sm",children:"种地中..."})]})})}e.s(["App",()=>eo],9843)}]);